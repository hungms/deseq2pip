% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/quality_control.R
\name{run_pca}
\alias{run_pca}
\title{Run Principal Component Analysis}
\usage{
run_pca(
  dds,
  group_by = "Group1",
  shape = NULL,
  size = 4,
  cols = NULL,
  save_data = T,
  save_plot = T,
  save_dir = getwd(),
  save_dir_name = "qc_results"
)
}
\arguments{
\item{dds}{A DESeq2 object containing the gene expression data}

\item{group_by}{Column name in colData(dds) to group by. Default is "Group1"}

\item{shape}{Column name in colData(dds) to use for shape in the PCA plot. Default is NULL}

\item{size}{Size of points in the PCA plot. Default is 4}

\item{cols}{Vector of colors to use for groups. If NULL, uses default ggplot2 colors. Default is NULL}

\item{save_data}{Logical. If TRUE, saves PCA results to TSV. Default is TRUE}

\item{save_plot}{Logical. If TRUE, saves the PCA plot to PDF. Default is TRUE}

\item{save_dir}{Directory to save the results. Default is the current working directory}

\item{save_dir_name}{Name of the subdirectory to save files in. Default is "qc_results"}
}
\value{
A ggplot object showing the PCA plot
}
\description{
This function performs PCA on the variance-stabilized transformed data and generates a PCA plot.
It can visualize sample relationships and identify potential batch effects or outliers.
}
\examples{
# Basic PCA plot
p <- run_pca(dds)

# PCA plot with shape and save results
p <- run_pca(dds, shape = "Batch", save_data = TRUE, save_dir_name = "custom_results")

# PCA plot with custom colors
p <- run_pca(dds, cols = c("red", "blue", "green"))
}
